
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Using Axios' Proxy Option - Mastering JS</title>

    <meta property="og:title" content="Using Axios' Proxy Option" />
    <meta property="og:site_name" content="Mastering JS" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="Axios has a `proxy` option that lets you send requests through a proxy. Here's how it works." />
    <meta name="description" content="Axios has a `proxy` option that lets you send requests through a proxy. Here's how it works." />
    <meta name="twitter:image" content="https://masteringjs.io/assets/logo.png">
    <meta property="og:image" content="https://masteringjs.io/assets/logo.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Consolas:400,700" rel="stylesheet">
    <link href="https://masteringjs.io/assets/logo.png" rel="shortcut icon" type="image/x-icon">
    <link href="https://masteringjs.io/assets/logo.png" rel="apple-touch-icon">

    <link rel="stylesheet" href="/assets/style.css" />
    <link rel="stylesheet" href="/assets/github.css" />
  
    <script src="//m.servedby-buysellads.com/monetization.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="allwrapper">
      
<div class="nav">
  <div class="branding">
    <div class="logo">
      <img src="/assets/logo.svg" alt="Mastering JS Logo">
    </div>
    <div class="name">
      <a href="/">Mastering JS</a>
    </div>
    <div class="links">
      <a href="/all">Tutorials</a>
      <a href="https://www.getrevue.co/profile/masteringjs">Newsletter</a>
      <a href="/ebooks/mastering-mongoose">eBooks</a>
    </div>
    <div style="clear: both"></div>
  </div>
</div>
<label class="hamburger-menu" for="burger-check">
  &#x2630;
</label>
<input id="burger-check" class="burger-check" type="checkbox" style="display: none" />
<div class="links-mobile">
  <a href="/all">Tutorials</a>
  <a href="https://www.getrevue.co/profile/masteringjs">Newsletter</a>
  <a href="/ebooks/mastering-mongoose">eBooks</a>
</div>

      <div class="content">
        
  <div class="breadcrumbs">
    <a href="/all">Tutorials</a>
    /
    <a href="/axios">Axios</a>
    /
  </div>
  <h1>Using Axios' Proxy Option</h1>
  <div class="date">
    Oct 26, 2020
  </div>
  <div id="default_masteringjsio"></div>
  <script>
	(function(){
	  if(typeof _bsa !== 'undefined' && _bsa) {
	    _bsa.init('default', 'CE7I62QE', 'placement:masteringjsio', { target: "#default_masteringjsio", align: "horizontal" });
	  }
	})();
	</script>
  <p><a href="/axios">Axios</a> supports a <code>proxy</code> option that lets you define an <a href="https://www.varonis.com/blog/what-is-a-proxy-server/">HTTP proxy</a> for your request. A proxied request is an HTTP request that Axios sends to a different server
(the <em>proxy server</em>) than the request is actually meant for. The idea is that the proxy server will do something
with the request before sending it to where the request is meant to go.</p>
<p>Below is the basic syntax of how you can proxy a request that is meant for <a href="http://httpbin.org/">httpbin.org</a> to
a proxy server listening on <code>localhost:3000</code>.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">'http://httpbin.org/get?answer=42'</span>, {
  <span class="hljs-comment">// `proxy` means the request actually goes to the server listening</span>
  <span class="hljs-comment">// on localhost:3000, but the request says it is meant for</span>
  <span class="hljs-comment">// 'http://httpbin.org/get?answer=42'</span>
  proxy: {
    <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>
  }
});
<span class="hljs-built_in">console</span>.log(res.data);</code></pre>
<h2 id="how-a-proxied-request-works-on-the-server">How A Proxied Request Works on the Server</h2>
<p>Let&#39;s take a look at the technical details of a proxied request. The <a href="https://www.npmjs.com/package/http-proxy">http-proxy npm package</a> is a popular HTTP proxy. Here&#39;s a script that listens on port 3000 and prints any requests before
sending them out to their intended destination.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> httpProxy = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http-proxy'</span>);

<span class="hljs-comment">// Create a proxy and listen on port 3000</span>
<span class="hljs-keyword">const</span> proxy = httpProxy.createProxyServer({});
<span class="hljs-keyword">const</span> app = express();
app.get(<span class="hljs-string">'*'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-comment">// Prints "Request GET https://httpbin.org/get?answer=42"</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Request'</span>, req.method, req.url);
  proxy.web(req, res, { <span class="hljs-attr">target</span>: <span class="hljs-string">`<span class="hljs-subst">${req.protocol}</span>://<span class="hljs-subst">${req.hostname}</span>`</span> });
});
<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">await</span> app.listen(<span class="hljs-number">3000</span>);

<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">'http://httpbin.org/get?answer=42'</span>, {
  <span class="hljs-comment">// `proxy` means the request actually goes to the server listening</span>
  <span class="hljs-comment">// on localhost:3000, but the request says it is meant for</span>
  <span class="hljs-comment">// 'http://httpbin.org/get?answer=42'</span>
  proxy: {
    <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>
  }
});
<span class="hljs-built_in">console</span>.log(res.data);
</code></pre>
<p>Notice that Express reports <code>req.url</code> is an <code>httpbin.org</code> URL! That&#39;s what we mean when we say Axios sends the
request to a different server than the request is intended for. The URL associated with the request, <code>req.url</code>,
is different than the proxy server&#39;s URL, and the proxy server is responsible for forwarding the request to <code>req.url</code>.</p>
<p>Proxy servers often do some sort of transformation to the request. For example, a proxy server may <a href="/tutorials/axios/authorization">set an authorization header</a> so your request doesn&#39;t have to.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> proxy = httpProxy.createProxyServer({});
proxy.on(<span class="hljs-string">'proxyReq'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">proxyReq</span>) </span>{
  proxyReq.setHeader(<span class="hljs-string">'Authorization'</span>, <span class="hljs-string">'my-secret-key'</span>);
});

<span class="hljs-keyword">const</span> app = express();
app.get(<span class="hljs-string">'*'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  proxy.web(req, res, { <span class="hljs-attr">target</span>: <span class="hljs-string">`<span class="hljs-subst">${req.protocol}</span>://<span class="hljs-subst">${req.hostname}</span>`</span> });
});
<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">await</span> app.listen(<span class="hljs-number">3000</span>);</code></pre>
<p>Now, if you make the same request with Axios, the proxy server will add the &#39;Authorization&#39; header for you, and httpbin.org will include it in the response.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">'http://httpbin.org/get?answer=42'</span>, {
  <span class="hljs-attr">proxy</span>: {
    <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>
  }
});
<span class="hljs-built_in">console</span>.log(res.data.headers[<span class="hljs-string">'authorization'</span>]); <span class="hljs-comment">// "my-secret-key"</span></code></pre>

  
  <hr>
  
    <h2>More Axios Tutorials</h2>
    <ul>
    
    <li><a href="/tutorials/fundamentals/array-to-string">How to Convert an Array to a String in JavaScript</a></li>
  

    <li><a href="/tutorials/axios/json">How to Use JSON with Axios</a></li>
  

    <li><a href="/tutorials/axios/user-agent">How to Use the User-Agent Header in Axios</a></li>
  

    <li><a href="/tutorials/axios/axios-multi-form-data">Axios Multipart Form Data</a></li>
  

    <li><a href="/tutorials/axios/create-post">How to use Axios' create() Method with POST Requests</a></li>
  

    <li><a href="/tutorials/axios/data">Axios Response `data` Property</a></li>
  

    <li><a href="/tutorials/axios/call">Calling Axios as a Function</a></li>
  
    </ul>
  

      </div>

      

<script type="text/javascript">
  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);

  xhr.setRequestHeader('Content-Type', 'application/json');

  xhr.onreadystatechange = function() {};
  xhr.send(JSON.stringify({
    path: window.location.pathname,
    hostname: window.location.hostname
  }));
</script>


      
    </div>

    <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7DLKQY&placement=masteringjsio" id="_carbonads_js"></script>
  </body>
</html>
